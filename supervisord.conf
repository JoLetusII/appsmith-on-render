; /etc/supervisor/supervisord.conf
[supervisord]
nodaemon=true
logfile=/appsmith-stacks/logs/supervisord.log

; ----- Appsmith core processes -----
[program:appsmith-server]
command=/opt/appsmith/scripts/start-server.sh
autostart=true
autorestart=true
stdout_logfile=/appsmith-stacks/logs/server.out.log
stderr_logfile=/appsmith-stacks/logs/server.err.log
environment=JAVA_TOOL_OPTIONS=-XX:+UseG1GC

[program:appsmith-worker]
command=/opt/appsmith/scripts/start-worker.sh
autostart=true
autorestart=true
stdout_logfile=/appsmith-stacks/logs/worker.out.log
stderr_logfile=/appsmith-stacks/logs/worker.err.log

; (Optional: if you rely on the image to run local Mongo/Redis/Postgres,
; their supervisor "programs" are already wired up in Appsmith’s scripts.)

; ----- Front proxy (nginx) instead of Caddy -----
[program:nginx]
command=/usr/sbin/nginx -g "daemon off;" -c /etc/nginx/nginx.conf
autostart=true
autorestart=true
stdout_logfile=/appsmith-stacks/logs/nginx.out.log
stderr_logfile=/appsmith-stacks/logs/nginx.err.log

; Supervisor’s web UI listens on 127.0.0.1:9001; nginx will proxy /supervisor/ to it.
[inet_http_server]
port=127.0.0.1:9001

